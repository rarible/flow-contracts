/*
Status		âœ… SEALED
ID		ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
Payer		d7db5ffc2d1c119b
Authorizers	[f4264ac8f3256818]

Proposal Key:	
    Address	f4264ac8f3256818
    Index	0
    Sequence	345

Payload Signature 0: f4264ac8f3256818
Envelope Signature 0: d7db5ffc2d1c119b
Signatures (minimized, use --include signatures)

Events:		 
    Index	0
    Type	A.f4264ac8f3256818.Evolution.CollectibleMinted
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10931 
		- itemId (UInt32): 27 
		- setId (UInt32): 1 
		- serialNumber (UInt32): 1 

    Index	1
    Type	A.f4264ac8f3256818.Evolution.CollectibleMinted
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10932 
		- itemId (UInt32): 27 
		- setId (UInt32): 1 
		- serialNumber (UInt32): 2 

    Index	2
    Type	A.f4264ac8f3256818.Evolution.CollectibleMinted
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10933 
		- itemId (UInt32): 27 
		- setId (UInt32): 1 
		- serialNumber (UInt32): 3 

    Index	3
    Type	A.f4264ac8f3256818.Evolution.CollectibleMinted
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10934 
		- itemId (UInt32): 27 
		- setId (UInt32): 1 
		- serialNumber (UInt32): 4 

    Index	4
    Type	A.f4264ac8f3256818.Evolution.CollectibleMinted
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10935 
		- itemId (UInt32): 27 
		- setId (UInt32): 1 
		- serialNumber (UInt32): 5 

    Index	5
    Type	A.f4264ac8f3256818.Evolution.CollectibleMinted
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10936 
		- itemId (UInt32): 27 
		- setId (UInt32): 1 
		- serialNumber (UInt32): 6 

    Index	6
    Type	A.f4264ac8f3256818.Evolution.CollectibleMinted
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10937 
		- itemId (UInt32): 27 
		- setId (UInt32): 1 
		- serialNumber (UInt32): 7 

    Index	7
    Type	A.f4264ac8f3256818.Evolution.CollectibleMinted
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10938 
		- itemId (UInt32): 27 
		- setId (UInt32): 1 
		- serialNumber (UInt32): 8 

    Index	8
    Type	A.f4264ac8f3256818.Evolution.CollectibleMinted
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10939 
		- itemId (UInt32): 27 
		- setId (UInt32): 1 
		- serialNumber (UInt32): 9 

    Index	9
    Type	A.f4264ac8f3256818.Evolution.Withdraw
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10931 
		- from (Never?): nil 

    Index	10
    Type	A.f4264ac8f3256818.Evolution.Deposit
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10931 
		- to (Address?): 0xf4264ac8f3256818 

    Index	11
    Type	A.f4264ac8f3256818.Evolution.Withdraw
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10932 
		- from (Never?): nil 

    Index	12
    Type	A.f4264ac8f3256818.Evolution.Deposit
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10932 
		- to (Address?): 0xf4264ac8f3256818 

    Index	13
    Type	A.f4264ac8f3256818.Evolution.Withdraw
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10933 
		- from (Never?): nil 

    Index	14
    Type	A.f4264ac8f3256818.Evolution.Deposit
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10933 
		- to (Address?): 0xf4264ac8f3256818 

    Index	15
    Type	A.f4264ac8f3256818.Evolution.Withdraw
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10934 
		- from (Never?): nil 

    Index	16
    Type	A.f4264ac8f3256818.Evolution.Deposit
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10934 
		- to (Address?): 0xf4264ac8f3256818 

    Index	17
    Type	A.f4264ac8f3256818.Evolution.Withdraw
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10935 
		- from (Never?): nil 

    Index	18
    Type	A.f4264ac8f3256818.Evolution.Deposit
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10935 
		- to (Address?): 0xf4264ac8f3256818 

    Index	19
    Type	A.f4264ac8f3256818.Evolution.Withdraw
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10936 
		- from (Never?): nil 

    Index	20
    Type	A.f4264ac8f3256818.Evolution.Deposit
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10936 
		- to (Address?): 0xf4264ac8f3256818 

    Index	21
    Type	A.f4264ac8f3256818.Evolution.Withdraw
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10937 
		- from (Never?): nil 

    Index	22
    Type	A.f4264ac8f3256818.Evolution.Deposit
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10937 
		- to (Address?): 0xf4264ac8f3256818 

    Index	23
    Type	A.f4264ac8f3256818.Evolution.Withdraw
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10938 
		- from (Never?): nil 

    Index	24
    Type	A.f4264ac8f3256818.Evolution.Deposit
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10938 
		- to (Address?): 0xf4264ac8f3256818 

    Index	25
    Type	A.f4264ac8f3256818.Evolution.Withdraw
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10939 
		- from (Never?): nil 

    Index	26
    Type	A.f4264ac8f3256818.Evolution.Deposit
    Tx ID	ffa9dd3f0e6cfd3533e3c2e65465d4040fd6a2cd719d26206be5afcc60207bb6
    Values
		- id (UInt64): 10939 
		- to (Address?): 0xf4264ac8f3256818 

*/

import Evolution from "../contracts/Evolution.cdc"

// This transaction mints multiple Collectibles
// from a single set/item combination (otherwise known as edition)

transaction(recipient: Address, setId: UInt32, itemId: UInt32) {

    // Local variable for the Evolution Admin object
    let adminRef: &Evolution.Admin

    prepare(acct: AuthAccount) {

        // borrow a reference to the Admin resource in storage
        self.adminRef = acct.borrow<&Evolution.Admin>(from: /storage/EvolutionAdmin)!
    }

    execute {
        // borrow a reference to the set to be minted from
        let setRef = self.adminRef.borrowSet(setId: setId)

        // Mint all the new NFTs
        let collection <- setRef.batchMintCollectible(itemId: itemId, quantity: 9)

        // Get the account object for the recipient of the minted tokens
        let recipient = getAccount(recipient)

        // get the Collection reference for the receiver
        let receiverRef = recipient.getCapability(/public/f4264ac8f3256818_Evolution_Collection).borrow<&{Evolution.EvolutionCollectionPublic}>()
            ?? panic("Cannot borrow a reference to the recipient's collection")

        // deposit the NFT in the receivers collection
        receiverRef.batchDeposit(tokens: <-collection)
    }
}
